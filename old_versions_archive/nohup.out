/home/tapsifoodseo/product_category/category_classifier_llm4.py:55: FutureWarning: 

All support for the `google.generativeai` package has ended. It will no longer be receiving 
updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
See README for more details:

https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md

  import google.generativeai as genai
=== AI PRODUCT CLASSIFIER (gemini-3-flash-preview) ===
Input file:  tf_menu.csv
Output file: tf_menu_labeled_v5.csv
Taxonomy:    category_definitions3.json
Workers:     6 | Batch size: 25 | RPS: 10
Retries:     6 | Backoff base: 2.0s | Timeout: 180s

Loading tf_menu.csv...
Total Products: 519,816
Already Processed: 200 products
Remaining to Process: 519,616

Processing 519,616 items in 20,785 batches...
  0%|          | 0/20785 [00:00<?, ?batch/s]  0%|          | 1/20785 [00:19<111:03:06, 19.24s/batch]  0%|          | 2/20785 [00:35<99:45:58, 17.28s/batch]   0%|          | 3/20785 [01:01<124:23:12, 21.55s/batch]  0%|          | 4/20785 [01:22<122:59:20, 21.31s/batch]  0%|          | 5/20785 [01:45<126:28:50, 21.91s/batch]  0%|          | 6/20785 [02:05<122:03:19, 21.15s/batch]  0%|          | 7/20785 [02:25<119:32:08, 20.71s/batch]  0%|          | 8/20785 [02:43<114:35:21, 19.85s/batch]  0%|          | 9/20785 [03:07<122:08:41, 21.16s/batch]  0%|          | 10/20785 [03:32<129:08:47, 22.38s/batch]  0%|          | 11/20785 [03:58<136:04:21, 23.58s/batch]  0%|          | 12/20785 [04:20<132:18:37, 22.93s/batch]  0%|          | 13/20785 [04:42<130:35:23, 22.63s/batch]  0%|          | 14/20785 [05:05<132:19:31, 22.93s/batch]  0%|          | 15/20785 [05:24<125:07:28, 21.69s/batch]  0%|          | 16/20785 [05:48<129:06:51, 22.38s/batch]  0%|          | 17/20785 [06:10<129:07:47, 22.38s/batch]  0%|          | 18/20785 [06:32<127:33:21, 22.11s/batch]  0%|          | 19/20785 [06:57<132:26:59, 22.96s/batch]  0%|          | 20/20785 [07:19<130:30:08, 22.63s/batch]  0%|          | 21/20785 [07:41<129:50:42, 22.51s/batch]  0%|          | 22/20785 [08:05<132:04:21, 22.90s/batch]  0%|          | 23/20785 [08:27<131:50:42, 22.86s/batch]  0%|          | 24/20785 [08:54<138:36:34, 24.04s/batch]  0%|          | 25/20785 [09:18<138:13:26, 23.97s/batch]  0%|          | 26/20785 [09:39<132:25:36, 22.97s/batch]  0%|          | 27/20785 [10:00<129:30:22, 22.46s/batch]  0%|          | 28/20785 [10:20<124:52:22, 21.66s/batch]  0%|          | 29/20785 [10:43<127:01:11, 22.03s/batch]  0%|          | 30/20785 [11:06<129:44:50, 22.50s/batch]  0%|          | 31/20785 [11:34<138:56:27, 24.10s/batch]  0%|          | 32/20785 [11:55<133:50:09, 23.22s/batch]  0%|          | 33/20785 [12:17<130:39:07, 22.67s/batch]  0%|          | 34/20785 [12:36<125:39:17, 21.80s/batch]  0%|          | 35/20785 [12:55<120:36:10, 20.92s/batch]  0%|          | 36/20785 [13:17<122:45:21, 21.30s/batch]  0%|          | 37/20785 [13:45<133:03:33, 23.09s/batch]  0%|          | 38/20785 [14:05<127:44:15, 22.16s/batch]  0%|          | 39/20785 [14:25<124:43:38, 21.64s/batch]  0%|          | 40/20785 [14:44<119:39:47, 20.77s/batch]  0%|          | 41/20785 [15:07<123:37:02, 21.45s/batch]  0%|          | 42/20785 [15:30<126:41:46, 21.99s/batch]  0%|          | 43/20785 [15:49<121:10:17, 21.03s/batch]  0%|          | 44/20785 [16:13<126:09:52, 21.90s/batch]  0%|          | 45/20785 [16:31<119:21:28, 20.72s/batch]  0%|          | 46/20785 [16:55<126:01:55, 21.88s/batch]  0%|          | 47/20785 [17:15<122:45:26, 21.31s/batch]  0%|          | 48/20785 [17:35<119:18:17, 20.71s/batch]  0%|          | 49/20785 [17:57<122:17:05, 21.23s/batch]  0%|          | 50/20785 [18:27<137:16:42, 23.83s/batch]  0%|          | 51/20785 [18:51<136:45:10, 23.74s/batch]  0%|          | 52/20785 [19:05<119:54:14, 20.82s/batch]  0%|          | 53/20785 [19:25<119:16:04, 20.71s/batch]  0%|          | 54/20785 [19:46<120:16:40, 20.89s/batch]  0%|          | 55/20785 [20:18<138:42:57, 24.09s/batch]  0%|          | 56/20785 [20:44<142:31:40, 24.75s/batch]  0%|          | 57/20785 [21:09<142:14:20, 24.70s/batch]  0%|          | 58/20785 [21:29<134:23:56, 23.34s/batch]  0%|          | 59/20785 [21:51<132:02:49, 22.94s/batch]  0%|          | 60/20785 [22:04<115:23:13, 20.04s/batch]  0%|          | 61/20785 [22:27<119:21:51, 20.73s/batch]  0%|          | 62/20785 [22:47<118:36:10, 20.60s/batch]  0%|          | 63/20785 [23:04<113:05:20, 19.65s/batch]  0%|          | 64/20785 [23:22<110:32:59, 19.21s/batch]  0%|          | 65/20785 [23:41<109:11:04, 18.97s/batch]  0%|          | 66/20785 [24:05<117:15:38, 20.37s/batch]  0%|          | 67/20785 [24:22<111:35:20, 19.39s/batch]  0%|          | 68/20785 [24:44<115:54:15, 20.14s/batch]  0%|          | 69/20785 [25:06<120:41:00, 20.97s/batch]  0%|          | 70/20785 [25:25<116:13:16, 20.20s/batch]  0%|          | 71/20785 [25:51<126:51:23, 22.05s/batch]  0%|          | 72/20785 [26:15<129:50:27, 22.57s/batch]  0%|          | 73/20785 [26:35<125:33:39, 21.82s/batch]  0%|          | 74/20785 [26:59<128:54:43, 22.41s/batch]  0%|          | 75/20785 [27:20<127:25:11, 22.15s/batch]  0%|          | 76/20785 [27:41<125:35:01, 21.83s/batch]  0%|          | 77/20785 [28:03<124:42:18, 21.68s/batch]  0%|          | 78/20785 [28:23<121:36:08, 21.14s/batch]  0%|          | 79/20785 [28:43<119:49:16, 20.83s/batch]  0%|          | 80/20785 [29:01<115:05:57, 20.01s/batch]  0%|          | 81/20785 [29:19<112:27:54, 19.56s/batch]  0%|          | 82/20785 [29:45<123:11:53, 21.42s/batch]  0%|          | 83/20785 [30:03<116:16:50, 20.22s/batch]  0%|          | 84/20785 [30:24<117:58:20, 20.52s/batch]  0%|          | 85/20785 [30:46<120:45:23, 21.00s/batch]  0%|          | 86/20785 [31:07<121:01:08, 21.05s/batch]  0%|          | 87/20785 [31:28<120:45:35, 21.00s/batch]  0%|          | 88/20785 [31:48<119:40:33, 20.82s/batch]  0%|          | 89/20785 [32:14<128:46:53, 22.40s/batch]  0%|          | 90/20785 [32:35<126:22:40, 21.98s/batch]  0%|          | 91/20785 [32:58<127:22:40, 22.16s/batch]  0%|          | 92/20785 [33:19<126:12:39, 21.96s/batch]  0%|          | 93/20785 [33:44<129:51:38, 22.59s/batch]  0%|          | 94/20785 [34:06<129:07:31, 22.47s/batch]  0%|          | 95/20785 [34:33<138:06:05, 24.03s/batch]  0%|          | 96/20785 [34:51<126:25:48, 22.00s/batch]  0%|          | 97/20785 [35:19<138:03:27, 24.02s/batch]  0%|          | 98/20785 [35:43<136:54:25, 23.82s/batch]  0%|          | 99/20785 [39:01<438:04:21, 76.24s/batch]  0%|          | 100/20785 [39:20<338:47:31, 58.96s/batch]  0%|          | 101/20785 [39:44<278:25:51, 48.46s/batch]  0%|          | 102/20785 [40:08<236:21:25, 41.14s/batch]  0%|          | 103/20785 [40:29<202:18:54, 35.22s/batch]  1%|          | 104/20785 [43:54<493:34:22, 85.92s/batch]  1%|          | 105/20785 [44:15<382:43:39, 66.63s/batch]  1%|          | 106/20785 [44:38<306:35:30, 53.37s/batch]  1%|          | 107/20785 [44:55<244:30:43, 42.57s/batch]  1%|          | 108/20785 [45:15<205:11:06, 35.72s/batch]  1%|          | 109/20785 [48:30<480:49:14, 83.72s/batch]  1%|          | 110/20785 [48:53<374:51:51, 65.27s/batch]  1%|          | 111/20785 [49:17<304:06:01, 52.95s/batch]  1%|          | 112/20785 [49:36<245:04:28, 42.68s/batch]  1%|          | 113/20785 [49:54<203:43:10, 35.48s/batch]  1%|          | 114/20785 [53:17<492:31:37, 85.78s/batch]  1%|          | 115/20785 [53:43<389:14:32, 67.79s/batch]  1%|          | 116/20785 [54:04<308:13:47, 53.69s/batch]  1%|          | 117/20785 [54:26<253:56:23, 44.23s/batch]  1%|          | 118/20785 [54:49<216:08:49, 37.65s/batch]  1%|          | 119/20785 [58:08<495:02:05, 86.23s/batch]  1%|          | 120/20785 [58:33<388:43:08, 67.72s/batch]  1%|          | 121/20785 [58:57<313:16:08, 54.58s/batch]  1%|          | 122/20785 [59:20<259:47:20, 45.26s/batch]  1%|          | 123/20785 [1:02:39<525:08:48, 91.50s/batch]Traceback (most recent call last):
  File "/home/tapsifoodseo/product_category/category_classifier_llm4.py", line 50, in <module>
    import pandas as pd
ModuleNotFoundError: No module named 'pandas'
/home/tapsifoodseo/product_category/category_classifier_llm4.py:55: FutureWarning: 

All support for the `google.generativeai` package has ended. It will no longer be receiving 
updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
See README for more details:

https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md

  import google.generativeai as genai
=== AI PRODUCT CLASSIFIER (gemini-3-flash-preview) ===
Input file:  tf_menu.csv
Output file: tf_menu_labeled_v5.csv
Taxonomy:    category_definitions3.json
Workers:     10 | Batch size: 40 | RPS: 10
Retries:     6 | Backoff base: 2.0s | Timeout: 180s

Loading tf_menu.csv...
Total Products: 519,816
Already Processed: 3,275 products
Remaining to Process: 516,541

Processing 516,541 items in 12,914 batches...
  0%|          | 0/12914 [00:00<?, ?batch/s]  0%|          | 1/12914 [00:29<107:21:57, 29.93s/batch]  0%|          | 2/12914 [01:03<114:36:31, 31.95s/batch]  0%|          | 3/12914 [01:34<112:55:03, 31.49s/batch]  0%|          | 4/12914 [02:05<112:43:30, 31.43s/batch]  0%|          | 5/12914 [02:32<107:06:56, 29.87s/batch]  0%|          | 6/12914 [05:59<323:17:39, 90.17s/batch]  0%|          | 7/12914 [06:31<254:35:12, 71.01s/batch]  0%|          | 8/12914 [07:09<217:11:24, 60.58s/batch]  0%|          | 9/12914 [07:41<184:40:42, 51.52s/batch]  0%|          | 10/12914 [08:08<157:50:56, 44.04s/batch]  0%|          | 11/12914 [08:33<137:04:50, 38.25s/batch]  0%|          | 12/12914 [09:10<135:26:20, 37.79s/batch]  0%|          | 13/12914 [09:35<121:56:10, 34.03s/batch]  0%|          | 14/12914 [19:00<695:50:43, 194.19s/batch]  0%|          | 15/12914 [19:35<524:43:56, 146.45s/batch]  0%|          | 16/12914 [20:06<400:00:11, 111.65s/batch]  0%|          | 17/12914 [20:32<307:39:35, 85.88s/batch]   0%|          | 18/12914 [21:02<246:54:20, 68.93s/batch]  0%|          | 19/12914 [21:29<202:04:03, 56.41s/batch]  0%|          | 20/12914 [21:57<171:28:39, 47.88s/batch]